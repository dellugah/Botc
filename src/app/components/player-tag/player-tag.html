<div class="round_info">
  <img class="background_flag" src="/{{roundCycle}}.png" alt="">
  <img class="top_flag" src="/topFlag.png" alt="">
  <img class="bottom_flag" src="{{opposite}}" alt="" (click)="cycleDay()">
  <h1>Round</h1>
  <h1>{{roundCounter}}</h1>
</div>
<div class="player_list">
  @for( player of players.players; track player){
    <div class="player_tag">
      <div class="player_cont">
        <div class="player_profile">
          <img class="player_class_pic" src="{{player.playerRole.roleImage.toLowerCase()}}" alt="class_icon" (click)="(player.isDead = true)">
          @if(player.isDead){
            <img class="death_token active" src="/death_token.png" alt="dead" (click)="(player.isDead = false)">
          }
          @else{
            <img class="death_token" src="/death_token.png" alt="dead">
          }
          <div class="player_info">
            <h2 class="player_class"><span class="{{player.playerAlignment}}">{{player.playerRole.roleName.toUpperCase()}}</span></h2>
            <div class="player_status">
              @if(player.playerRole.roleName != player.registeredAs.roleName){
                <img src="{{player.registeredAs.roleImage.toLowerCase()}}" alt="" width="auto" height="200%">
              }
            </div>
            <h3 class="player_name">{{player.playerName}}</h3>
          </div>
        </div>
        <div class="player_ability">
          <!-- MONK ABILITY -->
          @if (isDay) {
            @if (executeMode) {
              @if(!player.isDead){
                <div class="nomination">
                  <div class="token_container">
                    <img class="left_base" src="/nomination_base.png" alt="" (click)="nominatedPlayer(player)">
                  </div>
                  @if(player.canNominate){
                    <div class="token_container">
                      <img class="left_base token"
                           src="/nomination_token.png" alt=""
                           (click)="nominatedPlayer(player)">
                    </div>
                  }
                  <img class="right_base" src="/nominated_base.png" alt="" (click)="wasNominated(player)">
                  @if(!player.wasIndicated){
                    <img class="right_base  token"
                         src="/nominated_token.png" alt=""
                         (click)="wasNominated(player)">
                  }
                </div>
              } @else{
                <div class="nomination">
                  <div class="token_container">
                    <img class="center_base" src="/ghost_vote_base.png" alt="" (click)="spendDeadVote(player)">
                    @if(player.hasDeadVote){
                      <img class="center_base token"
                           src="/ghost_vote_token.png" alt=""
                           (click)="spendDeadVote(player)">
                    }
                  </div>
                </div>
              }

            } @else {
              @if([Roles.VIRGIN, Roles.SLAYER].includes(player.playerRole.roleName)){
                <div class="token_container">
                  <img class="center_base" src="/ability_base.png" alt="" (click)="spendAbility(player)">
                  @if(player.hasAbility && !player.isDead){
                    <img class="center_base token"
                         src="/ability_token.png" alt=""
                         (click)="spendAbility(player)">
                  }
                </div>
              }
            }
          } @else{
            @if (player.playerRole.roleName === Roles.MONK) {
              <h2>Protects:</h2>
              <select [(ngModel)]="protectedPlayer" (ngModelChange)="monkTarget(player, $event)">
                <option [ngValue]=""></option>
                @for (p of players.players; track p) {
                  <option [ngValue]="p">{{ p.playerName }}</option>
                }
              </select>
              <!-- POISONER ABILITY -->
            } @else if (player.playerRole.roleName === Roles.POISONER) {
              <h2>Poisons:</h2>
              <select [(ngModel)]="poisonedPlayer" (ngModelChange)="poisonerTarget($event)">
                <option [ngValue]=""></option>
                @for (p of players.players; track p) {
                  <option [ngValue]="p">{{ p.playerName }}</option>
                }
              </select>
              <!-- FORTUNE TELLER / EMPATH ABILITY -->
            } @else if ([Roles.FORTUNE_TELLER, Roles.EMPATH].includes(player.playerRole.roleName)) {
              @if(player.hasAbility){
                <h2>Choose:</h2>
                <select>
                  <option value="1"></option>
                  @for (player of players.players; track player) {
                    <option [ngValue]="player">{{ player.playerName }}</option>
                  }
                </select>
                <h2>and</h2>
                <select>
                  <option value="1"></option>
                  @for (player of players.players; track player) {
                    <option [ngValue]="player">{{ player.playerName }}</option>
                  }
                </select>
                <h2>Learn:</h2>
                <select name="" id="">
                  <option value=""></option>
                  <option value="no">NO</option>
                  <option value="yes">YES</option>
                </select>
              }
              <!-- UNDERTAKER ABILITY -->
            } @else if ([Roles.UNDERTAKER].includes(player.playerRole.roleName)) {
              <h2>See:</h2>
              @if (player.isPoisoned || player.isDrunk) {
                <select>
                  <option value=" "></option>
                  @for (role of Object.values(Roles); track role){
                    <option [ngValue]="role">{{ role }}</option>
                  }
                </select>
              } @else{
                <select>
                  <option value=" "></option>
                  @for (player of players.players; track player) {
                    @if(player.isDead){
                      <option [ngValue]="player">{{ player.playerRole.roleName }}</option>
                    }
                  }
                </select>
              }

              <!-- RECLUSE / SPY ABILITY -->
            } @else if ([Roles.RECLUSE, Roles.SPY].includes(player.playerRole.roleName)) {
              <h2>Registers as:</h2>
              <select [(ngModel)]="player.registeredAs.roleName" (ngModelChange)="registerAs(player, $event)">
                <option value=""></option>
                @for (role of Object.values(Townsfolk); track role) {
                  <option [ngValue]="role">{{ role }}</option>
                }
                @for (role of Object.values(Outsiders); track role) {
                  <option [ngValue]="role">{{ role }}</option>
                }
                @for (role of Object.values(Minion); track role) {
                  <option [ngValue]="role">{{ role }}</option>
                }
              </select>
              <!-- IMP ABILITY -->
            } @else if (player.playerRole.roleName === Roles.IMP) {
              <h2>Kills:</h2>
              <select [(ngModel)]="markedForDeathPlayer" (ngModelChange)="markForDeath(player, $event)">
                <option [ngValue]="null"></option>
                @for (p of players.players; track p) {
                  <option [ngValue]="p">{{ p.playerName }}</option>
                }
              </select>
              <!-- RAVEN KEEPER ABILITY -->
            } @else if (player.playerRole.roleName === Roles.RAVEN_KEEPER){
              @if (player.isDead) {
                <h2>Choose:</h2>
                <select>
                  <option value=" "></option>
                  @for (player of players.players; track player) {
                    <option [ngValue]="player">{{ player.playerName }}</option>
                  }
                </select>
                <h2>Sees:</h2>
                <select>
                  <option value="1"></option>
                  @for (role of Object.values(Roles); track role) {
                    <option [ngValue]="role">{{ role }}</option>
                  }
                </select>
              }
            } @else if (player.playerRole.roleName === Roles.BUTLER){
              <h2>Choose:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <!-- WASHERWOMAN ABILITY -->
            } @else if (player.playerRole.roleName === Roles.WASHERWOMAN){
              <h2>Sees:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <h2>and:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <h2>sees:</h2>
              <select>
                <option value="1"></option>
                @for (role of Object.values(Townsfolk); track role) {
                  <option [ngValue]="role">{{ role }}</option>
                }
              </select>
              <!-- LIBRARIAN ABILITY -->
            } @else if (player.playerRole.roleName === Roles.LIBRARIAN) {
              <h2>Sees:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <h2>and:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <h2>sees:</h2>
              <select>
                <option value="1"></option>
                @for (role of Object.values(Outsider); track role) {
                  <option [ngValue]="role">{{ role }}</option>
                }
              </select>
              <!-- INVESTIGATOR ABILITY -->
            } @else if (player.playerRole.roleName === Roles.INVESTIGATOR) {
              <h2>Sees:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <h2>and:</h2>
              <select>
                <option value=" "></option>
                @for (player of players.players; track player) {
                  <option [ngValue]="player">{{ player.playerName }}</option>
                }
              </select>
              <h2>sees:</h2>
              <select>
                <option value="1"></option>
                @for (role of Object.values(Minion); track role) {
                  <option [ngValue]="role">{{ role }}</option>
                }
              </select>
              <!-- CHEF ABILITY -->
            } @else if (player.playerRole.roleName === Roles.CHEF) {
              <h2>Sees:</h2>
              <select>
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
              </select>
            }
          }
        </div>
        <div class="player_conditions">
          @if(player.isDrunk){
            <img class="condition" src="/drunk.webp" alt="Is the Drunk">
          }
          @if(player.isProtected){
            <img class="condition" src="/monk.webp" alt="protected">
          }
          @if(player.isPoisoned){
            <img class="condition" src="/poisoner.webp" alt="poisoned">
          }
          @if(player.isRedHearing){
            <img class="condition" src="/fortuneteller.webp" alt="Red Hearing">
          }
          @if(player.isMarkedForDeath){
            <img class="condition" src="/imp.webp" alt="Marked for Death">
          }
        </div>
      </div>
      <div class="player_options">
        <button><h2>Change Role</h2></button>
        <button><h2>Change Alignment </h2></button>
        <button><h2>Comments</h2></button>
      </div>
    </div>
  }
  <div id="ghost_tag"></div>
</div>
<div class="classes_info">
  <img class="top_flag" src="/topFlag.png" alt="">
  @if(isDay){
    @if(!executeMode){
      <h1>Talk</h1>
      <img class="background_flag" src="/talk_round.png" alt="">
      <img class="bottom_flag" src="/guillotineFlag.png" alt="" (click)="changeMode()">
    } @else {
      <h1>Nominate</h1>
      <img class="background_flag" src="/guillotine_round.png" alt="">
      <img class="bottom_flag" src="/talkFlag.png" alt="" (click)="changeMode()">
    }
  } @else{
    <h1>Wake</h1>
    <img class="wake_player" src="{{wakePlayer.toLowerCase()}}" alt="">
    <img class="next_wake" src="" alt="">
    <img class="background_flag" src="/wake_order.png" alt="">
    <img class="bottom_flag" src="/wakeFlag.png" alt="" (click)="wakePlayerSequence()">
  }
</div>
